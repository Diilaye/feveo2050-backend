#!/bin/bash

echo "üö® TOKEN WHATSAPP EXPIR√â - SOLUTION RAPIDE"
echo "========================================="
echo ""
echo "‚ùå PROBL√àME D√âTECT√â:"
echo "   ‚Ä¢ Token WhatsApp expir√© le 26 juillet 2025"
echo "   ‚Ä¢ App Secret manquant"
echo ""
echo "üéØ SOLUTION IMM√âDIATE (2 minutes):"
echo ""
echo "1Ô∏è‚É£ R√âCUP√âRER UN NOUVEAU TOKEN:"
echo "   ‚Üí Ouvrir: https://developers.facebook.com/apps/1500316664676674/whatsapp-business/wa-settings/"
echo "   ‚Üí Aller dans 'Configuration API'"
echo "   ‚Üí Cliquer 'G√©n√©rer le token' (dur√©e: 60 jours recommand√©e)"
echo "   ‚Üí COPIER le nouveau token"
echo ""
echo "2Ô∏è‚É£ METTRE √Ä JOUR LE FICHIER .env:"
echo "   ‚Üí Ouvrir: /Users/diikaanedev/Documents/feveo-projet/back/.env"
echo "   ‚Üí Remplacer la ligne WHATSAPP_ACCESS_TOKEN par le nouveau token"
echo ""
echo "3Ô∏è‚É£ RED√âMARRER ET TESTER:"
echo "   ‚Üí npm start"
echo "   ‚Üí node test-whatsapp.js"
echo ""

# Proposer d'ouvrir directement l'URL
echo "üåê Ouvrir l'URL de configuration WhatsApp maintenant ? (y/n)"
read -r response
if [[ "$response" =~ ^[Yy]$ ]]; then
    echo "üìÇ Ouverture de la console WhatsApp..."
    open "https://developers.facebook.com/apps/1500316664676674/whatsapp-business/wa-settings/"
    echo "‚úÖ Console ouverte - G√©n√©rez votre nouveau token"
fi

echo ""
echo "‚ö° ALTERNATIVE RAPIDE - MODE DEV:"
echo "   Le syst√®me fonctionne d√©j√† en mode fallback"
echo "   Les codes de v√©rification s'affichent dans les logs"
echo "   Vous pouvez continuer le d√©veloppement sans bloquer"
echo ""
echo "üí° APR√àS MISE √Ä JOUR DU TOKEN:"
echo "   ‚Üí Le syst√®me passera automatiquement en mode WhatsApp"
echo "   ‚Üí Plus de messages dans les logs, envoi r√©el"
echo "   ‚Üí Renouvellement automatique activ√©"
