#!/bin/bash

echo "üöÄ FEVEO 2050 - R√©cup√©ration Token WhatsApp"
echo "============================================="
echo ""
echo "üìã Informations de votre App :"
echo "   ‚Ä¢ App ID: 1500316664676674"
echo "   ‚Ä¢ Business ID: 1129220308584592"
echo ""
echo "üîó URLs importantes :"
echo ""
echo "1Ô∏è‚É£ Dashboard Principal :"
echo "   https://developers.facebook.com/apps/1500316664676674/dashboard/?business_id=1129220308584592"
echo ""
echo "2Ô∏è‚É£ Configuration WhatsApp :"
echo "   https://developers.facebook.com/apps/1500316664676674/whatsapp-business/wa-settings/"
echo ""
echo "3Ô∏è‚É£ Param√®tres de Base (pour App Secret) :"
echo "   https://developers.facebook.com/apps/1500316664676674/settings/basic/"
echo ""
echo "üîß Instructions :"
echo ""
echo "√âTAPE 1 - R√©cup√©rer l'App Secret :"
echo "   1. Cliquez sur le lien 'Param√®tres de Base' ci-dessus"
echo "   2. Trouvez 'Cl√© secr√®te de l'app'"
echo "   3. Cliquez sur 'Afficher' et copiez"
echo "   4. Ajoutez dans .env : WHATSAPP_APP_SECRET=votre_secret"
echo ""
echo "√âTAPE 2 - R√©cup√©rer un Nouveau Token :"
echo "   1. Cliquez sur le lien 'Configuration WhatsApp' ci-dessus"
echo "   2. Allez dans 'Configuration API'"
echo "   3. Section 'Token d'acc√®s' ‚Üí 'G√©n√©rer le token'"
echo "   4. Copiez le nouveau token"
echo "   5. Remplacez dans .env : WHATSAPP_ACCESS_TOKEN=nouveau_token"
echo ""
echo "√âTAPE 3 - Tester :"
echo "   1. Red√©marrez le serveur : npm start"
echo "   2. Testez : node test-auto-token.js"
echo ""

# Fonction pour ouvrir les URLs sur macOS
if [[ "$OSTYPE" == "darwin"* ]]; then
    echo "üåê Voulez-vous ouvrir les URLs dans votre navigateur ? (y/n)"
    read -r response
    if [[ "$response" =~ ^[Yy]$ ]]; then
        echo "üìÇ Ouverture des onglets..."
        open "https://developers.facebook.com/apps/1500316664676674/settings/basic/"
        sleep 2
        open "https://developers.facebook.com/apps/1500316664676674/whatsapp-business/wa-settings/"
        echo "‚úÖ URLs ouvertes dans votre navigateur"
    fi
fi

echo ""
echo "üí° Apr√®s configuration, votre .env devrait contenir :"
echo "   WHATSAPP_APP_ID=1500316664676674"
echo "   WHATSAPP_APP_SECRET=votre_app_secret"
echo "   WHATSAPP_BUSINESS_ID=1129220308584592"
echo "   WHATSAPP_PHONE_NUMBER_ID=658687160670733"
echo "   WHATSAPP_ACCESS_TOKEN=nouveau_token"
echo ""
echo "üîÑ Le syst√®me g√©rera ensuite automatiquement le renouvellement !"
